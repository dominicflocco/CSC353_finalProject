USE Baseball;


DROP PROCEDURE IF EXISTS PitcherSeasonAggregate;
DELIMITER //
CREATE PROCEDURE PitcherSeasonAggregate(start_year VARCHAR(4), finish_year VARCHAR(4), stat VARCHAR(20))

BEGIN
    IF (stat = 'G') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_percent,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY G LIMIT 0,100;


    ELSEIF (stat = 'IP') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY IP DESC
	   	LIMIT 0,100;
    ELSEIF (stat = 'AB') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY AB DESC LIMIT 0,100;


    ELSEIF (stat = 'PA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY PA DESC LIMIT 0,100;


    ELSEIF (stat = 'H') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY H DESC LIMIT 0,100;


    ELSEIF (stat = '1B') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY 1B DESC LIMIT 0,100;


    ELSEIF (stat = '2B') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY 2B DESC LIMIT 0,100;


    ELSEIF (stat = '3B') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY 3B DESC LIMIT 0,100;


    ELSEIF (stat = 'HR') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY HR DESC LIMIT 0,100;


    ELSEIF (stat = 'K') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY K DESC LIMIT 0,100;


    ELSEIF (stat = 'BB') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY BB DESC LIMIT 0,100;


    ELSEIF (stat = 'HBP') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY HBP DESC LIMIT 0,100;


    ELSEIF (stat = 'K_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY K_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'BB_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY BB_percent LIMIT 0,100;


    ELSEIF (stat = 'BAA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY BAA LIMIT 0,100;


    ELSEIF (stat = 'SLG') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY SLG LIMIT 0,100;


    ELSEIF (stat = 'OBP') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY OBP LIMIT 0,100;


    ELSEIF (stat = 'OPS') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY OPS LIMIT 0,100;


    ELSEIF (stat = 'ER') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY ER DESC LIMIT 0,100;


    ELSEIF (stat = 'R') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY R DESC LIMIT 0,100;


    ELSEIF (stat = 'SV') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY SV DESC LIMIT 0,100;


    ELSEIF (stat = 'BS') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY BS DESC LIMIT 0,100;


    ELSEIF (stat = 'W') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY W DESC LIMIT 0,100;


    ELSEIF (stat = 'L') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY L DESC LIMIT 0,100;


    ELSEIF (stat = 'ERA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY ERA LIMIT 0,100;


    ELSEIF (stat = 'xBA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY xBA LIMIT 0,100;


    ELSEIF (stat = 'xSLG') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY xSLG LIMIT 0,100;


    ELSEIF (stat = 'wOBA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY wOBA LIMIT 0,100;


    ELSEIF (stat = 'xwOBA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY xwOBA LIMIT 0,100;


    ELSEIF (stat = 'xOBP') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY xOBP LIMIT 0,100;


    ELSEIF (stat = 'xISO') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY xISO LIMIT 0,100;


    ELSEIF (stat = 'four_seam_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY four_seam_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'four_seam_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY four_seam_avg_speed DESC LIMIT 0,100;


    ELSEIF (stat = 'four_seam_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY four_seam_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'slider_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY slider_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'slider_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY slider_avg_speed DESC LIMIT 0,100;
    ELSEIF (stat = 'slider_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY slider_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'changeup_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY changeup_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'changeup_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY changeup_avg_speed DESC LIMIT 0,100;


    ELSEIF (stat = 'changeup_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY changeup_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'curveball_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY curveball_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'curveball_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY curveball_avg_speed DESC LIMIT 0,100;


    ELSEIF (stat = 'curveball_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY curveball_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'sinker_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY sinker_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'sinker_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY sinker_avg_speed DESC LIMIT 0,100;


    ELSEIF (stat = 'sinker_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
    ORDER BY sinker_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'cutter_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY cutter_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'cutter_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY cutter_avg_speed DESC LIMIT 0,100;


    ELSEIF (stat = 'cutter_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY cutter_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'splitter_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY splitter_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'splitter_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY splitter_avg_speed DESC LIMIT 0,100;


    ELSEIF (stat = 'splitter_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY splitter_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'knuckle_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY knuckle_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'knuckle_avg_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY knuckle_avg_speed DESC LIMIT 0,100;


    ELSEIF (stat = 'knuckle_avg_spin') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY knuckle_avg_spin DESC LIMIT 0,100;


    ELSEIF (stat = 'exit_velocity_avg') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY exit_velocity_avg DESC LIMIT 0,100;


    ELSEIF (stat = 'launch_angle_avg') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY launch_angle_avg DESC LIMIT 0,100;


    ELSEIF (stat = 'sweet_spot_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
	    ORDER BY sweet_spot_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'barrel_rate') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(IP) AS IP, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(BAA*AB)/SUM(AB) as BAA,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(ER) AS ER, SUM(R) AS R,
	    SUM(SV) AS SV, SUM(BS) AS BS, SUM(W) AS W, SUM(L) AS L,
	    SUM(ER)/(9*SUM(IP)) AS ERA, SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG,
	    SUM(wOBA*PA)/SUM(PA) as wOBA, SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP, (SUM(xSLG*AB)/SUM(AB)-SUM(xBA*AB)/SUM(AB)) AS xISO,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    SUM(Pitches) AS Pitches,
	    SUM(four_seam_percent*Pitches)/SUM(Pitches) AS four_seam_percent,
	    SUM(four_seam_avg_mph*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_speed,
	    SUM(four_seam_avg_spin*four_seam_percent*Pitches)/SUM(four_seam_percent*Pitches) AS four_seam_avg_spin,
	    SUM(slider_percent*Pitches)/SUM(Pitches) AS slider_percent,
	    SUM(slider_avg_speed*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_speed,
	    SUM(slider_avg_spin*slider_percent*Pitches)/SUM(slider_percent*Pitches) AS slider_avg_spin,
	    SUM(changeup_percent*Pitches)/SUM(Pitches) AS changeup_percent,
	    SUM(changeup_avg_speed*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_speed,
	    SUM(changeup_avg_spin*changeup_percent*Pitches)/SUM(changeup_percent*Pitches) AS changeup_avg_spin,
	    SUM(curveball_percent*Pitches)/SUM(Pitches) AS curveball_avg_spin,
	    SUM(curveball_avg_speed*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_speed,
	    SUM(curveball_avg_spin*curveball_percent*Pitches)/SUM(curveball_percent*Pitches) AS curveball_avg_spin,
	    SUM(sinker_percent*Pitches)/SUM(Pitches) AS sinker_percent,
	    SUM(sinker_avg_speed*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_speed,
	    SUM(sinker_avg_spin*sinker_percent*Pitches)/SUM(sinker_percent*Pitches) AS sinker_avg_spin,
	    SUM(cutter_percent*Pitches)/SUM(Pitches) AS cutter_percent,
	    SUM(cutter_avg_speed*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_speed,
	    SUM(cutter_avg_spin*cutter_percent*Pitches)/SUM(cutter_percent*Pitches) AS cutter_avg_spin,
	    SUM(splitter_percent*Pitches)/SUM(Pitches) AS splitter_percent,
	    SUM(splitter_avg_speed*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_speed,
	    SUM(splitter_avg_spin*splitter_percent*Pitches)/SUM(splitter_percent*Pitches) AS splitter_avg_spin,
	    SUM(knuckle_percent*Pitches)/SUM(Pitches) AS knuckle_percent,
	    SUM(knuckle_avg_speed*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_speed,
	    SUM(knuckle_avg_spin*knuckle_percent*Pitches)/SUM(knuckle_percent*Pitches) AS knuckle_avg_spin
	    FROM (PitcherSeasonStats NATURAL JOIN Players) WHERE season>=start_year AND season<=finish_year
	    GROUP BY player_id
    	ORDER BY barrel_rate DESC LIMIT 0,100;

    END IF;
END
//
DELIMITER ;

DROP PROCEDURE IF EXISTS batterSeasonAggregate;
DELIMITER //
CREATE PROCEDURE batterSeasonAggregate(start_year VARCHAR(4), end_year VARCHAR(4), stat VARCHAR(20))
BEGIN
    IF (stat = 'G') THEN
		SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
		SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
		SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
		SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
		SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
		(SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
		 SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
		SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
		SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
		SUM(xISO*AB)/SUM(AB) as xISO,
		-- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
		-- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
		-- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
		-- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
		-- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
		-- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
		-- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
		-- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
		-- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
		-- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
		-- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
		-- -- AVG(whiff_percent) AS whiff_percent,
		AVG(sprint_speed) as sprint_speed
		FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year GROUP BY player_id
		ORDER BY G DESC LIMIT 0,100;

    ELSEIF (stat = 'AB') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY AB DESC LIMIT 0,100;


    ELSEIF (stat = 'PA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY PA DESC LIMIT 0,100;


    ELSEIF (stat = 'H') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY H DESC LIMIT 0,100;


    ELSEIF (stat = '1B') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY 1B DESC LIMIT 0,100;


    ELSEIF (stat = '2B') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY 2B DESC LIMIT 0,100;


    ELSEIF (stat = '3B') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY 3B DESC LIMIT 0,100;


    ELSEIF (stat = 'HR') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY HR DESC LIMIT 0,100;


    ELSEIF (stat = 'K') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY K DESC LIMIT 0,100;


    ELSEIF (stat = 'BB') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY BB DESC LIMIT 0,100;


    ELSEIF (stat = 'K_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY K_percent LIMIT 0,100;


    ELSEIF (stat = 'BB_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY BB_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'Average') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY Average DESC LIMIT 0,100;


    ELSEIF (stat = 'SLG') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY SLG DESC LIMIT 0,100;


    ELSEIF (stat = 'OBP') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY OBP DESC LIMIT 0,100;


    ELSEIF (stat = 'OPS') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY OPS DESC LIMIT 0,100;


    ELSEIF (stat = 'RBI') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY RBI DESC LIMIT 0,100;


    ELSEIF (stat = 'SB') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY SB DESC LIMIT 0,100;


    ELSEIF (stat = 'CS') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY CS DESC LIMIT 0,100;


    ELSEIF (stat = 'HBP') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY HBP DESC LIMIT 0,100;


    ELSEIF (stat = 'R') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY R DESC LIMIT 0,100;


    ELSEIF (stat = 'SB_percent') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY SB_percent DESC LIMIT 0,100;


    ELSEIF (stat = 'xBA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY xBA DESC LIMIT 0,100;


    ELSEIF (stat = 'xSLG') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY xSLG DESC LIMIT 0,100;


    ELSEIF (stat = 'wOBA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY wOBA DESC LIMIT 0,100;


    ELSEIF (stat = 'xwOBA') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY xwOBA DESC LIMIT 0,100;


    ELSEIF (stat = 'xOBP') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY xOBP DESC LIMIT 0,100;


    ELSEIF (stat = 'xISO') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY xISO DESC LIMIT 0,100;


    ELSEIF (stat = 'sprint_speed') THEN
	    SELECT first_name, last_name, SUM(G) AS G, SUM(AB) AS AB, SUM(PA) AS PA,
	    SUM(H) AS H, SUM(1B) AS 1B, SUM(2B) AS 2B, SUM(3B) AS 3B, SUM(HR) AS HR,
	    SUM(K) AS K, SUM(BB) AS BB, SUM(K_percent*PA)/SUM(PA) as K_percent,
	    SUM(BB_percent*PA)/SUM(PA) as BB_percent, SUM(Average*AB)/SUM(AB) as Average,
	    SUM(SLG*AB)/SUM(AB) as SLG, SUM(OBP*PA)/SUM(PA) as OBP,
	    (SUM(OBP*PA)/SUM(PA) +  SUM(SLG*AB)/SUM(AB)) as OPS, SUM(RBI) AS RBI, SUM(SB) AS SB,
	     SUM(HBP) AS HBP, SUM(R) AS R, SUM(SB)/SUM(SB/SB_percent) AS SB_percent,
	    SUM(xBA*AB)/SUM(AB) as xBA, SUM(xSLG*AB)/SUM(AB) as xSLG, SUM(wOBA*PA)/SUM(PA) as wOBA,
	    SUM(xwOBA*PA)/SUM(PA) as xwOBA, SUM(xOBP*PA)/SUM(PA) as xOBP,
	    SUM(xISO*AB)/SUM(AB) as xISO,
	    -- SUM(wOBACON*batted_balls)/SUM(batted_balls) AS wOBACON,
	    -- SUM(xwBACON*batted_balls)/SUM(batted_balls) AS xwBACON, SUM(BACON*batted_balls)/SUM(batted_balls) AS BACON,
	    -- SUM(xBACON*batted_balls)/SUM(batted_balls) AS xBACON, SUM(batted_balls) AS batted_balls,
	    -- SUM(exit_velocity_avg*batted_balls)/SUM(batted_balls) AS exit_velocity_avg,
	    -- SUM(launch_angle_avg*batted_balls)/SUM(batted_balls) AS launch_angle_avg,
	    -- SUM(sweet_spot_percent*batted_balls)/SUM(batted_balls) AS sweet_spot_percent,
	    -- SUM(barrel_rate*batted_balls)/SUM(batted_balls) AS barrel_rate,
	    -- SUM(groundballs_percent*batted_balls)/SUM(batted_balls) AS groundballs_percent,
	    -- SUM(flyballs_percent*batted_balls)/SUM(batted_balls) AS flyballs_percent,
	    -- SUM(linedrives_percent*batted_balls)/SUM(batted_balls) AS linedrives_percent,
	    -- SUM(popups_percent*batted_balls)/SUM(batted_balls) AS popups_percent,
	    -- AVG(whiff_percent) AS whiff_percent,
	    AVG(sprint_speed) as sprint_speed
	    FROM BatterSeasonStats NATURAL JOIN Players WHERE season>=start_year AND season<=end_year
	    GROUP BY player_id
	    ORDER BY sprint_speed DESC LIMIT 0,100;
    END IF;
END
//
DELIMITER ;
